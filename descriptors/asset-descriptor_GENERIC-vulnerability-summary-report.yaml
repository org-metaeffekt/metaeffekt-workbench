inventories:
  - "inventory":
      folder: "${inventory.path}"
      type: INPUT
  - "reference-inventory":
      file: "${reference.inventory.path}"
      type: INPUT
      licensePath: "${reference.license.path}"
      componentPath: "${reference.component.path}"
  - "merged-assessments":
      file: "${computed.inventory.path}/${asset.name}-merged-assessments-inventory.xlsx"
      type: COMPUTED
  - "merged-advisors":
      file: "${computed.inventory.path}/${asset.name}-merged-advisors-inventory.xlsx"
      type: COMPUTED

transformations:
  "merge-assessments":
    inputInventories:
      - "inventory"
    outputInventories:
      - "merged-assessments"
    params:
      input.inventories.dir: "${inventory.file}"
      output.merged.inventory.file: "${merged-assessments.file}"
    maven:
      pom: "${workbench.processors.dir}/util/util_merge-assessments.xml"
      workingDir: "."
      command: "generate-sources"

  "merge-advisor-inventories":
    inputInventories:
      - "inventory"
    outputInventories:
      - "merged-advisors"
    params:
      input.reference.inventories.dir: "${inventory.file}"
      param.vulnerability.advisory.filter: ""
      output.filtered.inventory.file: "${merged-advisors.file}"
      securityPolicyFile: "${security.policy.file}"
      securityPolicyActiveIds: ""
    maven:
      pom: "${workbench.processors.dir}/util/util_merge-filter.xml"
      workingDir: "."
      command: "generate-sources"

documents:
  "vulnerability-summary-report":
    type: VULNERABILITY_SUMMARY_REPORT
    language: "${document.language}"
    parts:
      "vulnerability-summary-report-part":
        type: VULNERABILITY_SUMMARY_REPORT
        inventories:
          - inventoryRef: "merged-assessments"
            assetVersion: "${asset.version}"
            assetName: "${asset.name}"
        params:
          securityPolicyFile: "${param.security.policy.file}"
          securityPolicyActiveIds: "summary-report-overall"
      "vulnerability-statistics-report":
        type: VULNERABILITY_STATISTICS_REPORT
        inventories:
          - inventoryRef: "merged-advisors"
            assetVersion: "${asset.version}"
            assetName: "${asset.name}"
        params:
          securityPolicyFile: "${param.security.policy.file}"
          securityPolicyActiveIds: "summary-report-overall"
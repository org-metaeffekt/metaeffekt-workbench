inventories:
  - "inventory":
      file: "${inventory.path}"
      type: INPUT
  - "reference-inventory":
      folder: "${reference.inventory.path}"
      type: INPUT
      licensePath: "${reference.license.path}"
      componentPath: "${reference.component.path}"
  - "filtered-inventory":
      file: "${param.computed.inventory.dir}/${asset.name}-vulnerability-report-inventory.xlsx"
      type: COMPUTED

transformations:
  "transform-with-maven":
    inputInventories:
      - "inventory"
    outputInventories:
      - "filtered-inventory"
    params:
      param.reference.inventories.dir: "${reference-inventory.folder}"
      param.vulnerability.advisory.filter: '[{"name":"${overview.advisors}"}]'
      output.filtered.inventory.file: "${filtered-inventory.file}"
      param.security.policy.file: "${security.policy.file}"
      param.security.policy.active.ids: "vulnerability_configuration"
    maven:
      pom: "${workbench.processors.dir}/util/util_merge-filter.xml"
      workingDir: "."
      command: "process-sources"

documents:
  "vulnerability-report":
    type: VULNERABILITY_REPORT
    language: "${document.language}"
    params:
      #parameters for generated parts
      securityPolicyFile: "${security.policy.file}"

      #parameters for generated properties
      vulnerability.report.properties.reference: "inventory"

      #parameters for report content references (match with inventoryRef)
      vulnerability.statistics.report.content.reference: "filtered-inventory"
      vulnerability.report.content.reference: "inventory"
    parts:
      "statistics-report":
        type: VULNERABILITY_STATISTICS_REPORT
        inventories:
          - inventoryRef: "filtered-inventory"
            assetVersion: "${asset.version}"
            assetName: "${asset.name}"
        params:
          securityPolicyActiveIds: "vulnerability_configuration"
      "vulnerability-part":
        type: VULNERABILITY_REPORT
        inventories:
          - inventoryRef: "inventory"
            assetVersion: "${asset.version}"
            assetName: "${asset.name}"
        params:
          securityPolicyActiveIds: "vulnerability_configuration"